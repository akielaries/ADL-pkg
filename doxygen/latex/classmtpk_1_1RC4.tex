\hypertarget{classmtpk_1_1RC4}{}\doxysection{mtpk\+::RC4 Class Reference}
\label{classmtpk_1_1RC4}\index{mtpk::RC4@{mtpk::RC4}}


{\ttfamily \#include $<$rc4.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classmtpk_1_1RC4_a9456b14881187b9034092a51bd995332}{byte\+\_\+swap}} (uint8\+\_\+t $\ast$a, uint8\+\_\+t $\ast$b)
\item 
void \mbox{\hyperlink{classmtpk_1_1RC4_a7f78df47fd055968e84ae9814d3012f2}{trad\+\_\+swap}} (unsigned char $\ast$a, unsigned char $\ast$b)
\item 
void \mbox{\hyperlink{classmtpk_1_1RC4_a241338bfc1131ece12f8964fb14a407c}{XOR\+\_\+swap}} (unsigned char $\ast$a, unsigned char $\ast$b)
\item 
void \mbox{\hyperlink{classmtpk_1_1RC4_a12dea4619de094080a422045ba1f35da}{KSA}} (char $\ast$key, unsigned char $\ast$S, int swap\+\_\+type)
\item 
void \mbox{\hyperlink{classmtpk_1_1RC4_a775f4b5019d7756d1c9c6a7e379e6a14}{PRGA}} (unsigned char $\ast$S, char $\ast$plaintext, unsigned char $\ast$ciphertext, int swap\+\_\+type)
\item 
std\+::string \mbox{\hyperlink{classmtpk_1_1RC4_a83b075a0d58d785e743f38a83e43c6f0}{store\+\_\+hash}} (char $\ast$plaintext, unsigned char $\ast$hashtext, int swap\+\_\+type)
\item 
unsigned char $\ast$ \mbox{\hyperlink{classmtpk_1_1RC4_a5c07022bfab349fb887e8067e76c9664}{compute}} (char $\ast$key, char $\ast$plaintext, unsigned char $\ast$hashtext, int swap\+\_\+type)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{rc4_8hpp_source_l00072}{72}} of file \mbox{\hyperlink{rc4_8hpp_source}{rc4.\+hpp}}.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmtpk_1_1RC4_a9456b14881187b9034092a51bd995332}\label{classmtpk_1_1RC4_a9456b14881187b9034092a51bd995332}} 
\index{mtpk::RC4@{mtpk::RC4}!byte\_swap@{byte\_swap}}
\index{byte\_swap@{byte\_swap}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{byte\_swap()}{byte\_swap()}}
{\footnotesize\ttfamily void mtpk\+::\+RC4\+::byte\+\_\+swap (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{a,  }\item[{uint8\+\_\+t $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00050}{50}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050                                               \{}
\DoxyCodeLine{00051     uint8\_t swapped = *a;}
\DoxyCodeLine{00052     swapped = *a;}
\DoxyCodeLine{00053     *a = *b;}
\DoxyCodeLine{00054     *b = swapped;}
\DoxyCodeLine{00055 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmtpk_1_1RC4_a5c07022bfab349fb887e8067e76c9664}\label{classmtpk_1_1RC4_a5c07022bfab349fb887e8067e76c9664}} 
\index{mtpk::RC4@{mtpk::RC4}!compute@{compute}}
\index{compute@{compute}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{compute()}{compute()}}
{\footnotesize\ttfamily unsigned char $\ast$ mtpk\+::\+RC4\+::compute (\begin{DoxyParamCaption}\item[{char $\ast$}]{key,  }\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{hashtext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00141}{141}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00143                                                  \{}
\DoxyCodeLine{00144     \textcolor{keywordflow}{if} (ciphertext == NULL) \{}
\DoxyCodeLine{00145         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}[-\/] Error Allocating Memory"{}});}
\DoxyCodeLine{00146     \}}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148     \textcolor{comment}{// check for swap types 1-\/3}}
\DoxyCodeLine{00149     \textcolor{keywordflow}{if} (0 <= swap\_type \&\& swap\_type <= 2) \{}
\DoxyCodeLine{00150         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} S[\mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}];}
\DoxyCodeLine{00151         \mbox{\hyperlink{classmtpk_1_1RC4_a12dea4619de094080a422045ba1f35da}{KSA}}(key, S, swap\_type);}
\DoxyCodeLine{00152         \mbox{\hyperlink{classmtpk_1_1RC4_a775f4b5019d7756d1c9c6a7e379e6a14}{PRGA}}(S, plaintext, ciphertext, swap\_type);}
\DoxyCodeLine{00153     \}}
\DoxyCodeLine{00154 }
\DoxyCodeLine{00155     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type > 2) \{}
\DoxyCodeLine{00156         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}[-\/] Invalid swap\_type"{}});}
\DoxyCodeLine{00157     \}}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159     \textcolor{keywordflow}{return} ciphertext;}
\DoxyCodeLine{00160 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\+\_\+\+LIMIT}}.

\mbox{\Hypertarget{classmtpk_1_1RC4_a12dea4619de094080a422045ba1f35da}\label{classmtpk_1_1RC4_a12dea4619de094080a422045ba1f35da}} 
\index{mtpk::RC4@{mtpk::RC4}!KSA@{KSA}}
\index{KSA@{KSA}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{KSA()}{KSA()}}
{\footnotesize\ttfamily void mtpk\+::\+RC4\+::\+KSA (\begin{DoxyParamCaption}\item[{char $\ast$}]{key,  }\item[{unsigned char $\ast$}]{S,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00069}{69}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00069                                                             \{}
\DoxyCodeLine{00070     uint32\_t len = strlen(key);}
\DoxyCodeLine{00071     \textcolor{keywordtype}{int} j = 0;}
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}; i++) \{}
\DoxyCodeLine{00074         S[i] = i;}
\DoxyCodeLine{00075     \}}
\DoxyCodeLine{00076 }
\DoxyCodeLine{00077     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}; i++) \{}
\DoxyCodeLine{00078         j = (j + S[i] + key[i \% len]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00079 }
\DoxyCodeLine{00080         \textcolor{comment}{// choose swap algorithm based off swap\_type}}
\DoxyCodeLine{00081         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00082             \mbox{\hyperlink{classmtpk_1_1RC4_a241338bfc1131ece12f8964fb14a407c}{XOR\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00083         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 1) \{}
\DoxyCodeLine{00084             \mbox{\hyperlink{classmtpk_1_1RC4_a7f78df47fd055968e84ae9814d3012f2}{trad\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00085         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 2) \{}
\DoxyCodeLine{00086             \mbox{\hyperlink{classmtpk_1_1RC4_a9456b14881187b9034092a51bd995332}{byte\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00087         \}}
\DoxyCodeLine{00088     \}}
\DoxyCodeLine{00089 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}, and \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\+\_\+\+LIMIT}}.

\mbox{\Hypertarget{classmtpk_1_1RC4_a775f4b5019d7756d1c9c6a7e379e6a14}\label{classmtpk_1_1RC4_a775f4b5019d7756d1c9c6a7e379e6a14}} 
\index{mtpk::RC4@{mtpk::RC4}!PRGA@{PRGA}}
\index{PRGA@{PRGA}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{PRGA()}{PRGA()}}
{\footnotesize\ttfamily void mtpk\+::\+RC4\+::\+PRGA (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{S,  }\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{ciphertext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00091}{91}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00092                                                                \{}
\DoxyCodeLine{00093     \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00094     \textcolor{keywordtype}{int} j = 0;}
\DoxyCodeLine{00095 }
\DoxyCodeLine{00096     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} n = 0, len = strlen(plaintext); n < len; n++) \{}
\DoxyCodeLine{00097         i = (i + 1) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00098         j = (j + S[i]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100         \textcolor{comment}{// choose swap algorithm based off swap\_type}}
\DoxyCodeLine{00101         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00102             \mbox{\hyperlink{classmtpk_1_1RC4_a241338bfc1131ece12f8964fb14a407c}{XOR\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00103         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 1) \{}
\DoxyCodeLine{00104             \mbox{\hyperlink{classmtpk_1_1RC4_a7f78df47fd055968e84ae9814d3012f2}{trad\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00105         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 2) \{}
\DoxyCodeLine{00106             \mbox{\hyperlink{classmtpk_1_1RC4_a9456b14881187b9034092a51bd995332}{byte\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00107         \}}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109         uint32\_t rnd = S[(S[i] + S[j]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}];}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111         ciphertext[n] = rnd \string^ plaintext[n];}
\DoxyCodeLine{00112     \}}
\DoxyCodeLine{00113 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}.

\mbox{\Hypertarget{classmtpk_1_1RC4_a83b075a0d58d785e743f38a83e43c6f0}\label{classmtpk_1_1RC4_a83b075a0d58d785e743f38a83e43c6f0}} 
\index{mtpk::RC4@{mtpk::RC4}!store\_hash@{store\_hash}}
\index{store\_hash@{store\_hash}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{store\_hash()}{store\_hash()}}
{\footnotesize\ttfamily std\+::string mtpk\+::\+RC4\+::store\+\_\+hash (\begin{DoxyParamCaption}\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{hashtext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00115}{115}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00116                                                  \{}
\DoxyCodeLine{00117     \textcolor{comment}{// length of our plaintext}}
\DoxyCodeLine{00118     \textcolor{keywordtype}{int} len = strlen((\textcolor{keywordtype}{char} *)plaintext);}
\DoxyCodeLine{00119     \textcolor{comment}{// for snprintf declare a buffer}}
\DoxyCodeLine{00120     \textcolor{keywordtype}{char} buffer[len + 1];}
\DoxyCodeLine{00121     \textcolor{keywordtype}{int} size = \textcolor{keyword}{sizeof}(buffer);}
\DoxyCodeLine{00122 }
\DoxyCodeLine{00123     \textcolor{comment}{// initialize empty string}}
\DoxyCodeLine{00124     std::string stored\_text = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126     \textcolor{comment}{// traverse the hashtext appending each block to a string}}
\DoxyCodeLine{00127     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} index = 0, len = strlen(plaintext); index < len; index++) \{}
\DoxyCodeLine{00128         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00129             snprintf(buffer, size, \textcolor{stringliteral}{"{}|x\%02hhx|"{}}, hashtext[index]);}
\DoxyCodeLine{00130         \}}
\DoxyCodeLine{00131         \textcolor{comment}{// to format our hash to a string for future manipulation}}
\DoxyCodeLine{00132         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00133             snprintf(buffer, size, \textcolor{stringliteral}{"{}\%02hhX"{}}, hashtext[index]);}
\DoxyCodeLine{00134         \}}
\DoxyCodeLine{00135         \textcolor{comment}{// append the declared string}}
\DoxyCodeLine{00136         stored\_text += std::string(buffer);}
\DoxyCodeLine{00137     \}}
\DoxyCodeLine{00138     \textcolor{keywordflow}{return} stored\_text;}
\DoxyCodeLine{00139 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmtpk_1_1RC4_a7f78df47fd055968e84ae9814d3012f2}\label{classmtpk_1_1RC4_a7f78df47fd055968e84ae9814d3012f2}} 
\index{mtpk::RC4@{mtpk::RC4}!trad\_swap@{trad\_swap}}
\index{trad\_swap@{trad\_swap}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{trad\_swap()}{trad\_swap()}}
{\footnotesize\ttfamily void mtpk\+::\+RC4\+::trad\+\_\+swap (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{a,  }\item[{unsigned char $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00057}{57}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00057                                                           \{}
\DoxyCodeLine{00058     \textcolor{keywordtype}{int} swapped = *a;}
\DoxyCodeLine{00059     *a = *b;}
\DoxyCodeLine{00060     *b = swapped;}
\DoxyCodeLine{00061 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classmtpk_1_1RC4_a241338bfc1131ece12f8964fb14a407c}\label{classmtpk_1_1RC4_a241338bfc1131ece12f8964fb14a407c}} 
\index{mtpk::RC4@{mtpk::RC4}!XOR\_swap@{XOR\_swap}}
\index{XOR\_swap@{XOR\_swap}!mtpk::RC4@{mtpk::RC4}}
\doxysubsubsection{\texorpdfstring{XOR\_swap()}{XOR\_swap()}}
{\footnotesize\ttfamily void mtpk\+::\+RC4\+::\+XOR\+\_\+swap (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{a,  }\item[{unsigned char $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00063}{63}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00063                                                          \{}
\DoxyCodeLine{00064     *a \string^= *b;}
\DoxyCodeLine{00065     *b \string^= *a;}
\DoxyCodeLine{00066     *a \string^= *b;}
\DoxyCodeLine{00067 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/nt/\mbox{\hyperlink{rc4_8hpp}{rc4.\+hpp}}\item 
modules/nt/\mbox{\hyperlink{rc4_8cpp}{rc4.\+cpp}}\end{DoxyCompactItemize}
